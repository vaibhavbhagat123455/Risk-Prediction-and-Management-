<!-- In templates/risks.html, replace the entire Filter Section with this: -->
<!-- Filter Section -->
<div class="bg-white p-6 rounded-lg shadow-sm border mb-6">
    <h2 class="text-xl font-semibold mb-4">Filter Risks</h2>
    <form method="get" action="/risks" class="flex gap-4" id="filterForm">
        <select name="project_id" class="border rounded px-3 py-2 flex-1" onchange="handleFilterChange()">
            <option value="">All Projects</option>
            {% for project in projects %}
            <option value="{{ project.id }}" 
                {% if selected_project_id == project.id %}selected{% endif %}>
                {{ project.name }}
            </option>
            {% endfor %}
        </select>
        <button type="submit" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">
            Filter
        </button>
        <button type="button" onclick="clearFilter()" class="bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600">
            Clear
        </button>
    </form>
</div>

<script>
    function handleFilterChange() {
        const select = document.querySelector('select[name="project_id"]');
        if (select.value === '') {
            // If "All Projects" is selected, submit the form without project_id parameter
            window.location.href = '/risks';
        }
    }
    
    function clearFilter() {
        window.location.href = '/risks';
    }
    
    // Prevent form submission when "All Projects" is selected
    document.getElementById('filterForm').addEventListener('submit', function(e) {
        const select = document.querySelector('select[name="project_id"]');
        if (select.value === '') {
            e.preventDefault();
            window.location.href = '/risks';
        }
    });
</script>